<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Classification with an Academic Success Dataset</title>
    <meta name="description" content="Predict students' dropout and academic success using a multiclass classification model. Includes stratified K-fold cross-validation and model performance optimization.">
    <meta name="author" content="Suraj Wate">
    <meta name="keywords" content="Data Science, Machine Learning, Python">

    <!-- Open Graph Tags -->
    <meta property="og:title" content="Classification with an Academic Success Dataset">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://surajwate.com/blog/classification-with-an-academic-success-dataset/">
    <meta property="og:description" content="Predict students' dropout and academic success using a multiclass classification model. Includes stratified K-fold cross-validation and model performance optimization.">
    
    <meta property="og:site_name" content="Suraj Wate's Blog">
    
    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Classification with an Academic Success Dataset">
    <meta name="twitter:description" content="Predict students' dropout and academic success using a multiclass classification model. Includes stratified K-fold cross-validation and model performance optimization.">
    

    <link rel="stylesheet" href="/assets/css/base.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css"> <!-- Prism CSS -->
    <!-- Font Awesome for Icons -->
    <script defer="" src="https://kit.fontawesome.com/c39a85ddd3.js" crossorigin="anonymous"></script>
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/icons/favicon-16x16.png">
    <link rel="manifest" href="/assets/images/icons/site.webmanifest">

    <!-- IndieAuth -->
    <link rel="me" href="https://fosstodon.org/@suraj">
    <link rel="me" href="https://github.com/surajwate">
    <link rel="me" href="https://twitter.com/surajwate">
    <link rel="me" href="https://linkedin.com/in/surajwate">
    <link rel="webmention" href="https://webmention.io/surajwate.com/webmention">

    <link rel="authorization_endpoint" href="https://indieauth.com/auth">
    <link rel="token_endpoint" href="https://tokens.indieauth.com/token">
    <link rel="microsub" href="https://aperture.p3k.io/microsub/978">

         
<link rel="stylesheet" href="/assets/css/post.css">

<!-- Custom Prism CSS -->
<link rel="stylesheet" href="/assets/css/prism-custom.css">
<!--- Custom Table Styles -->
<link rel="stylesheet" href="/assets/css/table-styles.css">

<meta property="og:type" content="article">

<script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    window.MathJax = {
        tex: {
            inlineMath: [
                ["$", "$"],
                ["\\(", "\\)"],
            ],
            displayMath: [
                ["$$", "$$"],
                ["\\[", "\\]"],
            ],
        },
    };
</script>

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "Classification with an Academic Success Dataset",
        "description": "Predict students&#39; dropout and academic success using a multiclass classification model. Includes stratified K-fold cross-validation and model performance optimization.",
        "datePublished": "Thu Sep 12 2024 00:00:00 GMT+0000 (Coordinated Universal Time)",
        "author": {
            "@type": "Person",
            "name": "Suraj Wate"
        },
        "publisher": {
            "@type": "Person",
            "name": "Suraj Wate's Blog"
        },
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://surajwate.com/blog/classification-with-an-academic-success-dataset/"
        },
        "image": ["/path/to/lead-image.png"],
        "articleSection": "Kaggle Challenges, Machine Learning Projects",
        "keywords": "Kaggle, XGBoost, Machine-Learning, Data-Science, Multiclass-Classification",
        "inLanguage": "en"
    }
</script>



    <!-- Google tag (gtag.js) -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3VGQDQ5YQV"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-3VGQDQ5YQV');
    </script>
</head>
<body>
    <header>
        <nav class="navbar">
            <a href="/" class="logo">Suraj Wate</a>
            <button class="nav-toggle" aria-label="Toggle navigation">
                <span class="hamburger"></span>
            </button>
            <ul class="nav-links">
                <li><a href="/blog"><i class="fa-regular fa-newspaper"></i> Blog</a></li>
                <li><a href="/projects"><i class="fa-solid fa-laptop-code"></i> Projects</a></li>
                <li><a href="/about"><i class="fas fa-user"></i> About Me</a></li>
                <li><a href="/contact"><i class="fas fa-envelope"></i> Contact</a></li>
            </ul>
        </nav>
    </header>
    
    <main>
        
<div class="post-container container">
    <h1>Classification with an Academic Success Dataset</h1>
    <p class="post-date">Sep 12, 2024</p>
    <h2>Overview</h2>
<p>This is the second challenge of the <a href="https://surajwate.com/projects/30-days-of-kaggle-challenges/">30 Kaggle Challenges in 30 Days</a> series. Yesterday, we worked on a <a href="https://surajwate.com/blog/binary-classification-of-insurance-cross-selling/">binary classification for insurance cross-selling</a>, and today, we are tackling a multiclass classification problem to predict students’ academic outcomes.</p>
<h2>Kaggle Season 4 Episode 6</h2>
<p>The dataset for this competition was generated from a deep learning model trained on the <a href="https://archive.ics.uci.edu/dataset/697/predict+students+dropout+and+academic+success">Predict Students’ Dropout and Academic Success</a> dataset. The features are close to, but not exactly the same as, the original. Our task is to build a multiclassification model to predict students’ dropout and academic success.<br>
This is a 3-category classification problem with a notable imbalance between classes.</p>
<h2>Exploratory Data Analysis (EDA)</h2>
<h3>Dataset Overview</h3>
<pre class="language-python"><code class="language-python">train <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>train<span class="token punctuation">.</span>csv<span class="token punctuation">)</span>
train<span class="token punctuation">.</span>shape</code></pre>
<p>(76518, 38)</p>
<p>The train dataset has 76518 rows and 38 columns. Next, we will check the value counts of the target variable. Before that, you can check the head to get an idea of the various columns. But this dataset has so many columns that I can’t write them here (it won’t look good).</p>
<pre class="language-python"><code class="language-python">train<span class="token punctuation">.</span>Target<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<pre class="language-shell"><code class="language-shell">Target
Graduate    <span class="token number">36282</span>
Dropout     <span class="token number">25296</span>
Enrolled    <span class="token number">14940</span>
Name: count, dtype: int64</code></pre>
<p><img src="/assets/images/Kaggle-S4E6-Target-Distribution.png" alt="Distribution of Target Variable in Kaggle S4E6 Problem" loading="lazy"></p>
<p>From the plot, you can see that the majority of the students graduated, 33% dropped out, and the rest enrolled. There is an imbalance in the target feature. As the evaluation metric is accuracy, having imbalanced data can give us a wrong idea about the perfection of our model. We will need to handle the data imbalance to make good predictions in all categories.</p>
<h3>Missing Values</h3>
<p>Checked for missing values. Train dataset don’t have any missing values.</p>
<pre class="language-python"><code class="language-python">train<span class="token punctuation">.</span>isna<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<pre class="language-txt"><code class="language-txt">id                                                0
Marital status                                    0
Application mode                                  0
Application order                                 0
Course                                            0
Daytime/evening attendance                        0
Previous qualification                            0
Previous qualification (grade)                    0
Nacionality                                       0
Mother's qualification                            0
Father's qualification                            0
Mother's occupation                               0
Father's occupation                               0
Admission grade                                   0
Displaced                                         0
Educational special needs                         0
Debtor                                            0
Tuition fees up to date                           0
Gender                                            0
Scholarship holder                                0
Age at enrollment                                 0
International                                     0
Curricular units 1st sem (credited)               0
Curricular units 1st sem (enrolled)               0
Curricular units 1st sem (evaluations)            0
Curricular units 1st sem (approved)               0
Curricular units 1st sem (grade)                  0
Curricular units 1st sem (without evaluations)    0
Curricular units 2nd sem (credited)               0
Curricular units 2nd sem (enrolled)               0
Curricular units 2nd sem (evaluations)            0
Curricular units 2nd sem (approved)               0
Curricular units 2nd sem (grade)                  0
Curricular units 2nd sem (without evaluations)    0
Unemployment rate                                 0
Inflation rate                                    0
GDP                                               0
Target                                            0
dtype: int64</code></pre>
<h3>Data Types</h3>
<p>Check the datatypes of the features.</p>
<pre class="language-python"><code class="language-python">train<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<pre class="language-txt"><code class="language-txt">&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 76518 entries, 0 to 76517
Data columns (total 38 columns):
 #   Column                                          Non-Null Count  Dtype  
---  ------                                          --------------  -----  
 0   id                                              76518 non-null  int64  
 1   Marital status                                  76518 non-null  int64  
 2   Application mode                                76518 non-null  int64  
 3   Application order                               76518 non-null  int64  
 4   Course                                          76518 non-null  int64  
 5   Daytime/evening attendance                      76518 non-null  int64  
 6   Previous qualification                          76518 non-null  int64  
 7   Previous qualification (grade)                  76518 non-null  float64
 8   Nacionality                                     76518 non-null  int64  
 9   Mother's qualification                          76518 non-null  int64  
 10  Father's qualification                          76518 non-null  int64  
 11  Mother's occupation                             76518 non-null  int64  
 12  Father's occupation                             76518 non-null  int64  
 13  Admission grade                                 76518 non-null  float64
 14  Displaced                                       76518 non-null  int64  
 15  Educational special needs                       76518 non-null  int64  
 16  Debtor                                          76518 non-null  int64  
 17  Tuition fees up to date                         76518 non-null  int64  
 18  Gender                                          76518 non-null  int64  
 19  Scholarship holder                              76518 non-null  int64  
 20  Age at enrollment                               76518 non-null  int64  
 21  International                                   76518 non-null  int64  
 22  Curricular units 1st sem (credited)             76518 non-null  int64  
 23  Curricular units 1st sem (enrolled)             76518 non-null  int64  
 24  Curricular units 1st sem (evaluations)          76518 non-null  int64  
 25  Curricular units 1st sem (approved)             76518 non-null  int64  
 26  Curricular units 1st sem (grade)                76518 non-null  float64
 27  Curricular units 1st sem (without evaluations)  76518 non-null  int64  
 28  Curricular units 2nd sem (credited)             76518 non-null  int64  
 29  Curricular units 2nd sem (enrolled)             76518 non-null  int64  
 30  Curricular units 2nd sem (evaluations)          76518 non-null  int64  
 31  Curricular units 2nd sem (approved)             76518 non-null  int64  
 32  Curricular units 2nd sem (grade)                76518 non-null  float64
 33  Curricular units 2nd sem (without evaluations)  76518 non-null  int64  
 34  Unemployment rate                               76518 non-null  float64
 35  Inflation rate                                  76518 non-null  float64
 36  GDP                                             76518 non-null  float64
 37  Target                                          76518 non-null  object 
dtypes: float64(7), int64(30), object(1)
memory usage: 22.2+ MB</code></pre>
<p>As you can see, all of the features except the target feature are numerical. The reason for this is that all of the data is already encoded. Features like <code>Marital status</code>, <code>Application mode</code>, <code>Course</code>, etc. are categorical data originally and the description is available at <a href="https://archive.ics.uci.edu/dataset/697/predict+students+dropout+and+academic+success">UCI ML Repository</a>.</p>
<p>First, we will use the data directly in the numerical form provided by Kaggle. Later, we can convert the data into its categorical form to do feature engineering.</p>
<p>Our main goal is to build an ML model, so I am not going to do detailed data analysis. However, it would be helpful if we were required to do feature engineering. I have prepared plots and detailed statistics on each feature in <a href="https://github.com/surajwate/S4E6-Academic-Success/blob/c3f1db3c39239e6554facfccb6dc43fcd651867/notebooks/eda.ipynb">jupyter notebook</a> in case you are interested in going through it.</p>
<h2>Handling Imbalance with Stratified K-Fold Cross-Validation</h2>
<p>The next task is to create a stratified K-fold cross-validation from the training set to validate the models before building the final model. By validating the models on different folds, we can gain insights into how well the model will perform on unseen data. Since the target variable is highly imbalanced, using a stratified K-fold ensures that each fold maintains the same proportion of the target variable as in the original dataset.</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> StratifiedKFold

<span class="token keyword">def</span> <span class="token function">create_fold</span><span class="token punctuation">(</span>fold<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># import data</span>
    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./input/train.csv'</span><span class="token punctuation">)</span>
    data<span class="token punctuation">[</span><span class="token string">'kfold'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
    data <span class="token operator">=</span> data<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>frac<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    y <span class="token operator">=</span> data<span class="token punctuation">.</span>Target<span class="token punctuation">.</span>values
    skf <span class="token operator">=</span> StratifiedKFold<span class="token punctuation">(</span>n_splits<span class="token operator">=</span>fold<span class="token punctuation">)</span>
    <span class="token keyword">for</span> f<span class="token punctuation">,</span> <span class="token punctuation">(</span>t_<span class="token punctuation">,</span> v_<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>skf<span class="token punctuation">.</span>split<span class="token punctuation">(</span>X<span class="token operator">=</span>data<span class="token punctuation">,</span> y<span class="token operator">=</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>v_<span class="token punctuation">,</span> <span class="token string">'kfold'</span><span class="token punctuation">]</span> <span class="token operator">=</span> f
    data<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'./input/train_folds.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    create_fold<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span></code></pre>
<h2>Feature Scaling</h2>
<p>Scaling the numerical features. Since all the features have numerical data type, we will scale all features.</p>
<pre class="language-python"><code class="language-python"><span class="token comment"># Initialize the StandardScaler</span>
scaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Fit and transform the training data</span>
X_train <span class="token operator">=</span> scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
X_test <span class="token operator">=</span> scaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></code></pre>
<h2>Model Training and Evaluation</h2>
<p>We will not try different models and evaluate their performance. The evaluation metric is <strong>accuracy</strong>.</p>
<h3>Logistic Regression</h3>
<pre class="language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression</code></pre>
<p>Results:</p>
<pre class="language-txt"><code class="language-txt">Fold=0, Accuracy=0.8187401986408782
Fold=1, Accuracy=0.814231573444851
Fold=2, Accuracy=0.8159958180867747
Fold=3, Accuracy=0.8163105273475789
Fold=4, Accuracy=0.8166372606678429</code></pre>
<h3>Decision Tree Classifier</h3>
<pre class="language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier</code></pre>
<p>Results:</p>
<pre class="language-txt"><code class="language-txt">Fold=0, Accuracy=0.7449032932566649
Fold=1, Accuracy=0.7400679560899112
Fold=2, Accuracy=0.7374542603240982
Fold=3, Accuracy=0.7370450238515324
Fold=4, Accuracy=0.7412925570149644</code></pre>
<h3>Random Forest Classifier</h3>
<pre class="language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier</code></pre>
<p>Results:</p>
<pre class="language-txt"><code class="language-txt">Fold=0, Accuracy=0.8278881338212232
Fold=1, Accuracy=0.8227914270778881
Fold=2, Accuracy=0.8259278619968635
Fold=3, Accuracy=0.8231719270731229
Fold=4, Accuracy=0.8272887669084493</code></pre>
<h3>SVM</h3>
<pre class="language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVC</code></pre>
<p>Results:</p>
<pre class="language-txt"><code class="language-txt">Fold=0, Accuracy=0.8208311552535285
Fold=1, Accuracy=0.8147543125980136
Fold=2, Accuracy=0.8207004704652379
Fold=3, Accuracy=0.8194471672221133
Fold=4, Accuracy=0.8220610337842253</code></pre>
<h3>Gradient Boosting Classifier</h3>
<pre class="language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> GradientBoostingClassifier</code></pre>
<p>Results:</p>
<pre class="language-txt"><code class="language-txt">Fold=0, Accuracy=0.8295216936748563
Fold=1, Accuracy=0.8273000522739153
Fold=2, Accuracy=0.8282148457919498
Fold=3, Accuracy=0.8248709403384957
Fold=4, Accuracy=0.8280729268770829</code></pre>
<h3>XGBoost Classifier</h3>
<pre class="language-python"><code class="language-python"><span class="token keyword">from</span> xgboost <span class="token keyword">import</span> XGBClassifier</code></pre>
<p>Results:</p>
<pre class="language-txt"><code class="language-txt">Fold=0, Accuracy=0.8325927861996864
Fold=1, Accuracy=0.8284762153685311
Fold=2, Accuracy=0.8296523784631469
Fold=3, Accuracy=0.8267006469319741
Fold=4, Accuracy=0.8330392733450958</code></pre>
<h3>Model Comparison</h3>
<p>Here’s a comparison of the models tested:</p>
<p><img src="/assets/images/Kaggle-S4E6-model_performance_comparison.png" alt="Comparison of the models tested for Kaggle S4E6" loading="lazy"></p>
<table>
<thead>
<tr>
<th>Model</th>
<th>Average Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td>Logistic Regression</td>
<td>81.64%</td>
</tr>
<tr>
<td>Decision Tree Classifier</td>
<td>74.01%</td>
</tr>
<tr>
<td>Random Forest Classifier</td>
<td>82.59%</td>
</tr>
<tr>
<td>SVM</td>
<td>81.96%</td>
</tr>
<tr>
<td>Gradient Boosting</td>
<td>82.76%</td>
</tr>
<tr>
<td><strong>XGBoost</strong></td>
<td><strong>83.01%</strong></td>
</tr>
</tbody>
</table>
<p>XGBoost gave us the best results, making it the model of choice for final submission.</p>
<h2>Final Model and Submission</h2>
<p>We have selected the XGBoost for our final submission. After training on the entire dataset, we achieved a final accuracy score of 83.45%.</p>
<p>You can check the code in <a href="https://www.kaggle.com/code/surajwate/academic-success-xgboost">Kaggle Notebook</a>.</p>
<h2>Key Learnings</h2>
<ul>
<li><strong>Label Encoding for XGBoost</strong>: XGBoost does not accept string values in the target variable, so I had to label encode the target values.</li>
<li><strong>Automated Model Testing</strong>: I have implemented a command-line script to automate the running of multiple models using different folds. This allows me to efficiently test various models, streamlining the experimentation process. I will write a detailed blog on this topic, so stay tuned. For now, you can check the code in the <a href="https://github.com/surajwate/S4E6-Academic-Success">GitHub repository</a>.</li>
</ul>
<h2>Conclusion</h2>
<p>This was the second day of the 30 Kaggle Challenges in 30 Days series, and we successfully completed a multiclass classification problem. Feel free to try the code from Kaggle Notebook and share your result!</p>


<a href="/blog" class="back-to-blog">← Back to Blog</a>

<!-- Add Giscus Comment Section Here -->


    <section id="giscus-comments">
        <script src="https://giscus.app/client.js" data-repo="surajwate/surajwate.github.io" data-repo-id="R_kgDOMRXrqQ" data-category="General" data-category-id="DIC_kwDOMRXrqc4CiRIe" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" data-loading="lazy" crossorigin="anonymous" async=""></script>
    </section>
</div>

<a href="/blog" class="back-to-blog">← Back to Blog</a>


    </main>
    <footer>
        <div class="footer-container">
            <p>© 2024 Suraj Wate. All rights reserved.</p>
        </div>
    </footer>
    <!-- Prism JS -->
    <script defer="" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js"></script>
    <script defer="" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-python.min.js"></script>
    <script>
        const navToggle = document.querySelector('.nav-toggle');
        const navLinks = document.querySelector('.nav-links');
        
        navToggle.addEventListener('click', () => {
            navLinks.classList.toggle('active'); // Show/hide the navigation links
            navToggle.querySelector('.hamburger').classList.toggle('active'); // Animate the hamburger icon
        });
    </script>
    

</body></html>